Description: Fix checks of redirection.
Author: Thomas Goirand <zigo@debian.org>
Forwarded: no
Last-Update: 2015-12-16

--- python-django-openstack-auth-2.0.0.orig/openstack_auth/tests/tests.py
+++ python-django-openstack-auth-2.0.0/openstack_auth/tests/tests.py
@@ -363,7 +363,10 @@ class OpenStackAuthTestsV2(OpenStackAuth
 
         if next:
             expected_url = 'http://testserver%s' % next
-            self.assertEqual(response['location'], expected_url)
+            try:
+                self.assertEqual(response['location'], expected_url)
+            except AssertionError:
+                self.assertEqual(response['location'], next)
         else:
             self.assertRedirects(response, settings.LOGIN_REDIRECT_URL)
 
@@ -409,7 +412,10 @@ class OpenStackAuthTestsV2(OpenStackAuth
 
         if next:
             expected_url = 'http://testserver%s' % next
-            self.assertEqual(response['location'], expected_url)
+            try:
+                self.assertEqual(response['location'], expected_url)
+            except:
+                self.assertEqual(response['location'], next)
         else:
             self.assertRedirects(response, settings.LOGIN_REDIRECT_URL)
 
@@ -721,7 +727,10 @@ class OpenStackAuthTestsV3(OpenStackAuth
 
         if next:
             expected_url = 'http://testserver%s' % next
-            self.assertEqual(response['location'], expected_url)
+            try:
+                self.assertEqual(response['location'], expected_url)
+            except:
+                self.assertEqual(response['location'], next)
         else:
             self.assertRedirects(response, settings.LOGIN_REDIRECT_URL)
 
@@ -766,7 +775,10 @@ class OpenStackAuthTestsV3(OpenStackAuth
 
         if next:
             expected_url = 'http://testserver%s' % next
-            self.assertEqual(response['location'], expected_url)
+            try:
+                self.assertEqual(response['location'], expected_url)
+            except:
+                self.assertEqual(response['location'], next)
         else:
             self.assertRedirects(response, settings.LOGIN_REDIRECT_URL)
 
